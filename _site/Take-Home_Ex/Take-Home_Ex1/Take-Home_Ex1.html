<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dhreeti Shah">
<meta name="dcterms.date" content="2025-02-19">

<title>ISSS608-VAA - Take Home Exercise 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608-VAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03a/Hands-on_Ex03a.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03b/Hands-on_Ex03b.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04b/Hands-on_Ex04b.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04c/Hands-on_Ex04c.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4c</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05b.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05c.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5c</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05d.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5d</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05e.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5e</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-Class_Ex/In-Class_Ex01/In-Class_Ex01.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex1/Take-Home_Ex1.html" rel="" target="">
 <span class="dropdown-text">Take-Home Exercise 1</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Take Home Exercise 1</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Dhreeti Shah </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 19, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link active" data-scroll-target="#getting-started">1. Getting Started</a></li>
  <li><a href="#importing-data" id="toc-importing-data" class="nav-link" data-scroll-target="#importing-data">2. Importing data</a></li>
  <li><a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration">3.Data Exploration</a>
  <ul class="collapse">
  <li><a href="#summary-statistics" id="toc-summary-statistics" class="nav-link" data-scroll-target="#summary-statistics">3.1 Summary statistics</a></li>
  <li><a href="#select-relevant-columns" id="toc-select-relevant-columns" class="nav-link" data-scroll-target="#select-relevant-columns">3.3 Select relevant columns</a></li>
  </ul></li>
  <li><a href="#univariate-analysis" id="toc-univariate-analysis" class="nav-link" data-scroll-target="#univariate-analysis">4.Univariate Analysis</a>
  <ul class="collapse">
  <li><a href="#age-distribution" id="toc-age-distribution" class="nav-link" data-scroll-target="#age-distribution">4.1 Age Distribution</a></li>
  <li><a href="#heart-attack-occurrence" id="toc-heart-attack-occurrence" class="nav-link" data-scroll-target="#heart-attack-occurrence">4.2 Heart Attack Occurrence</a></li>
  </ul></li>
  <li><a href="#stratified-summary-statistics" id="toc-stratified-summary-statistics" class="nav-link" data-scroll-target="#stratified-summary-statistics">5. Stratified Summary Statistics</a>
  <ul class="collapse">
  <li><a href="#stratifed-correlation" id="toc-stratifed-correlation" class="nav-link" data-scroll-target="#stratifed-correlation">5.1 Stratifed Correlation</a></li>
  </ul></li>
  <li><a href="#bivariate-analysis" id="toc-bivariate-analysis" class="nav-link" data-scroll-target="#bivariate-analysis">6.Bivariate Analysis</a>
  <ul class="collapse">
  <li><a href="#heart-attack-by-age-group" id="toc-heart-attack-by-age-group" class="nav-link" data-scroll-target="#heart-attack-by-age-group">6.1 Heart attack by age group</a></li>
  <li><a href="#cholesterol-level-vs.-heart-attack" id="toc-cholesterol-level-vs.-heart-attack" class="nav-link" data-scroll-target="#cholesterol-level-vs.-heart-attack">6.3 Cholesterol Level vs.&nbsp;Heart Attack</a></li>
  </ul></li>
  <li><a href="#multivariate-analysis-relationships-between-multiple-variables" id="toc-multivariate-analysis-relationships-between-multiple-variables" class="nav-link" data-scroll-target="#multivariate-analysis-relationships-between-multiple-variables">7. Multivariate Analysis (Relationships Between Multiple Variables)</a>
  <ul class="collapse">
  <li><a href="#heart-attack-by-smoking-and-alcohol-consumption" id="toc-heart-attack-by-smoking-and-alcohol-consumption" class="nav-link" data-scroll-target="#heart-attack-by-smoking-and-alcohol-consumption">7.1 Heart Attack by Smoking and Alcohol Consumption</a></li>
  </ul></li>
  <li><a href="#statistical-visualizations-using-ggstatsplot" id="toc-statistical-visualizations-using-ggstatsplot" class="nav-link" data-scroll-target="#statistical-visualizations-using-ggstatsplot">8.Statistical Visualizations Using ggstatsplot</a></li>
  <li><a href="#violin-plot-bmi-distribution-by-heart-attack-occurrence" id="toc-violin-plot-bmi-distribution-by-heart-attack-occurrence" class="nav-link" data-scroll-target="#violin-plot-bmi-distribution-by-heart-attack-occurrence">9.Violin Plot: BMI Distribution by Heart Attack Occurrence</a></li>
  <li><a href="#heatmap-relationship-between-blood-pressure-heart-rate" id="toc-heatmap-relationship-between-blood-pressure-heart-rate" class="nav-link" data-scroll-target="#heatmap-relationship-between-blood-pressure-heart-rate">10.Heatmap: Relationship Between Blood Pressure &amp; Heart Rate</a>
  <ul class="collapse">
  <li><a href="#principal-component-analysis-pca" id="toc-principal-component-analysis-pca" class="nav-link" data-scroll-target="#principal-component-analysis-pca">11. Principal Component Analysis (PCA)</a></li>
  </ul></li>
  <li><a href="#random-forest" id="toc-random-forest" class="nav-link" data-scroll-target="#random-forest">12. Random Forest</a>
  <ul class="collapse">
  <li><a href="#splitting-the-data-to-balance-it-out" id="toc-splitting-the-data-to-balance-it-out" class="nav-link" data-scroll-target="#splitting-the-data-to-balance-it-out">12.1 Splitting the data to balance it out</a></li>
  <li><a href="#training-a-random-forest" id="toc-training-a-random-forest" class="nav-link" data-scroll-target="#training-a-random-forest">12.2 Training a random forest</a></li>
  <li><a href="#define-cross-validation-with-stratified-folds" id="toc-define-cross-validation-with-stratified-folds" class="nav-link" data-scroll-target="#define-cross-validation-with-stratified-folds">Define Cross-validation with stratified folds</a>
  <ul class="collapse">
  <li><a href="#train-a-random-forest-model-with-stratified-cross-validation" id="toc-train-a-random-forest-model-with-stratified-cross-validation" class="nav-link" data-scroll-target="#train-a-random-forest-model-with-stratified-cross-validation">Train a Random Forest model with stratified cross-validation</a></li>
  <li><a href="#model-summary" id="toc-model-summary" class="nav-link" data-scroll-target="#model-summary">Model Summary</a></li>
  <li><a href="#variable-importance" id="toc-variable-importance" class="nav-link" data-scroll-target="#variable-importance">Variable Importance</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion-and-summary" id="toc-conclusion-and-summary" class="nav-link" data-scroll-target="#conclusion-and-summary">13. Conclusion and Summary</a>
  <ul class="collapse">
  <li><a href="#feature-importance-random-forest-model" id="toc-feature-importance-random-forest-model" class="nav-link" data-scroll-target="#feature-importance-random-forest-model">13.1 Feature Importance (Random Forest Model)</a></li>
  <li><a href="#interaction-between-bmi-cholesterol-on-heart-attack-risk" id="toc-interaction-between-bmi-cholesterol-on-heart-attack-risk" class="nav-link" data-scroll-target="#interaction-between-bmi-cholesterol-on-heart-attack-risk">13.2 Interaction Between BMI &amp; Cholesterol on Heart Attack Risk</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<hr>
<section id="getting-started" class="level1">
<h1>1. Getting Started</h1>
<p>We will first load the the libraries needed for this assignment</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse,readr,easystats,gtsummary, SmartEDA, ggstatsplot,janitor,ggplot2,plotly,treemapify,dplyr,caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="importing-data" class="level1">
<h1>2. Importing data</h1>
<p>We are provided with Japan heart attack dataset which has different factors affected whether or not heart attack occurs</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>heart_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/japan_heart_attack_dataset.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-exploration" class="level1">
<h1>3.Data Exploration</h1>
<p>We will first start with data exploration to understand more about the data</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>heart_data <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ExpData</span>(<span class="at">type =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Index           Variable_Name Variable_Type Sample_n Missing_Count
1      1                     Age       numeric    30000             0
2      2                  Gender     character    30000             0
3      3                  Region     character    30000             0
4      4         Smoking_History     character    30000             0
5      5        Diabetes_History     character    30000             0
6      6    Hypertension_History     character    30000             0
7      7       Cholesterol_Level       numeric    30000             0
8      8       Physical_Activity     character    30000             0
9      9            Diet_Quality     character    30000             0
10    10     Alcohol_Consumption     character    30000             0
11    11           Stress_Levels       numeric    30000             0
12    12                     BMI       numeric    30000             0
13    13              Heart_Rate       numeric    30000             0
14    14             Systolic_BP       numeric    30000             0
15    15            Diastolic_BP       numeric    30000             0
16    16          Family_History     character    30000             0
17    17 Heart_Attack_Occurrence     character    30000             0
18    18          Extra_Column_1       numeric    30000             0
19    19          Extra_Column_2       numeric    30000             0
20    20          Extra_Column_3       numeric    30000             0
21    21          Extra_Column_4       numeric    30000             0
22    22          Extra_Column_5       numeric    30000             0
23    23          Extra_Column_6       numeric    30000             0
24    24          Extra_Column_7       numeric    30000             0
25    25          Extra_Column_8       numeric    30000             0
26    26          Extra_Column_9       numeric    30000             0
27    27         Extra_Column_10       numeric    30000             0
28    28         Extra_Column_11       numeric    30000             0
29    29         Extra_Column_12       numeric    30000             0
30    30         Extra_Column_13       numeric    30000             0
31    31         Extra_Column_14       numeric    30000             0
32    32         Extra_Column_15       numeric    30000             0
   Per_of_Missing No_of_distinct_values
1               0                    62
2               0                     2
3               0                     2
4               0                     2
5               0                     2
6               0                     2
7               0                 30000
8               0                     3
9               0                     3
10              0                     4
11              0                 29613
12              0                 30000
13              0                 30000
14              0                 30000
15              0                 30000
16              0                     2
17              0                     2
18              0                 30000
19              0                 30000
20              0                 30000
21              0                 30000
22              0                 30000
23              0                 30000
24              0                 30000
25              0                 30000
26              0                 30000
27              0                 30000
28              0                 30000
29              0                 30000
30              0                 30000
31              0                 30000
32              0                 30000</code></pre>
</div>
</div>
<p>This provides a brief understanding of the different variables, their type, missing value, distinct values and more</p>
<section id="summary-statistics" class="level2">
<h2 class="anchored" data-anchor-id="summary-statistics">3.1 Summary statistics</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(heart_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Age           Gender             Region          Smoking_History   
 Min.   :18.00   Length:30000       Length:30000       Length:30000      
 1st Qu.:33.00   Class :character   Class :character   Class :character  
 Median :48.00   Mode  :character   Mode  :character   Mode  :character  
 Mean   :48.49                                                           
 3rd Qu.:64.00                                                           
 Max.   :79.00                                                           
 Diabetes_History   Hypertension_History Cholesterol_Level Physical_Activity 
 Length:30000       Length:30000         Min.   : 80.02    Length:30000      
 Class :character   Class :character     1st Qu.:179.55    Class :character  
 Mode  :character   Mode  :character     Median :199.77    Mode  :character  
                                         Mean   :199.90                      
                                         3rd Qu.:220.16                      
                                         Max.   :336.86                      
 Diet_Quality       Alcohol_Consumption Stress_Levels         BMI       
 Length:30000       Length:30000        Min.   : 0.000   Min.   : 5.58  
 Class :character   Class :character    1st Qu.: 3.644   1st Qu.:21.63  
 Mode  :character   Mode  :character    Median : 4.993   Median :24.96  
                                        Mean   : 5.002   Mean   :25.00  
                                        3rd Qu.: 6.353   3rd Qu.:28.36  
                                        Max.   :10.000   Max.   :46.10  
   Heart_Rate      Systolic_BP      Diastolic_BP    Family_History    
 Min.   : 30.03   Min.   : 56.23   Min.   : 39.95   Length:30000      
 1st Qu.: 63.25   1st Qu.:109.79   1st Qu.: 73.26   Class :character  
 Median : 69.95   Median :119.90   Median : 80.12   Mode  :character  
 Mean   : 69.98   Mean   :119.91   Mean   : 80.03                     
 3rd Qu.: 76.66   3rd Qu.:130.02   3rd Qu.: 86.76                     
 Max.   :108.78   Max.   :178.77   Max.   :117.67                     
 Heart_Attack_Occurrence Extra_Column_1     Extra_Column_2     
 Length:30000            Min.   :0.000007   Min.   :0.0000052  
 Class :character        1st Qu.:0.253308   1st Qu.:0.2473606  
 Mode  :character        Median :0.500820   Median :0.4961980  
                         Mean   :0.501939   Mean   :0.4978940  
                         3rd Qu.:0.750529   3rd Qu.:0.7473954  
                         Max.   :0.999965   Max.   :0.9999894  
 Extra_Column_3      Extra_Column_4      Extra_Column_5     Extra_Column_6     
 Min.   :0.0000227   Min.   :0.0000934   Min.   :0.000105   Min.   :0.0000531  
 1st Qu.:0.2483093   1st Qu.:0.2522110   1st Qu.:0.251803   1st Qu.:0.2559989  
 Median :0.4976104   Median :0.4976175   Median :0.501987   Median :0.5017726  
 Mean   :0.4981949   Mean   :0.5005952   Mean   :0.501410   Mean   :0.5027631  
 3rd Qu.:0.7476807   3rd Qu.:0.7505662   3rd Qu.:0.753657   3rd Qu.:0.7511886  
 Max.   :0.9999694   Max.   :0.9999869   Max.   :0.999995   Max.   :0.9998892  
 Extra_Column_7      Extra_Column_8      Extra_Column_9     
 Min.   :0.0000678   Min.   :0.0000449   Min.   :0.0000305  
 1st Qu.:0.2482839   1st Qu.:0.2509790   1st Qu.:0.2502452  
 Median :0.4988157   Median :0.4985698   Median :0.4984491  
 Mean   :0.4980753   Mean   :0.5003557   Mean   :0.5002292  
 3rd Qu.:0.7456378   3rd Qu.:0.7507293   3rd Qu.:0.7512186  
 Max.   :0.9999900   Max.   :0.9999300   Max.   :0.9999852  
 Extra_Column_10     Extra_Column_11     Extra_Column_12    
 Min.   :0.0000133   Min.   :0.0000008   Min.   :0.0000713  
 1st Qu.:0.2484256   1st Qu.:0.2538092   1st Qu.:0.2505341  
 Median :0.5031040   Median :0.5067589   Median :0.5038609  
 Mean   :0.5010694   Mean   :0.5044949   Mean   :0.5008624  
 3rd Qu.:0.7522686   3rd Qu.:0.7556257   3rd Qu.:0.7511780  
 Max.   :0.9999928   Max.   :0.9999578   Max.   :0.9999484  
 Extra_Column_13     Extra_Column_14     Extra_Column_15    
 Min.   :0.0000204   Min.   :0.0000025   Min.   :0.0000241  
 1st Qu.:0.2473108   1st Qu.:0.2482152   1st Qu.:0.2482573  
 Median :0.5041162   Median :0.4943841   Median :0.5009406  
 Mean   :0.5004557   Mean   :0.4976507   Mean   :0.4999634  
 3rd Qu.:0.7497094   3rd Qu.:0.7456212   3rd Qu.:0.7487379  
 Max.   :0.9999451   Max.   :0.9999779   Max.   :0.9999913  </code></pre>
</div>
</div>
</section>
<section id="select-relevant-columns" class="level2">
<h2 class="anchored" data-anchor-id="select-relevant-columns">3.3 Select relevant columns</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select relevant variables</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>heart_data <span class="ot">&lt;-</span> heart_data <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Age, Gender, Region, Smoking_History, Diabetes_History,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>         Hypertension_History, Cholesterol_Level, Physical_Activity,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>         Diet_Quality, Alcohol_Consumption, Stress_Levels, BMI,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>         Heart_Rate, Systolic_BP, Diastolic_BP, Family_History,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>         Heart_Attack_Occurrence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the original distribution of Heart_Attack_Occurrence</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(heart_data<span class="sc">$</span>Heart_Attack_Occurrence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   No   Yes 
27036  2964 </code></pre>
</div>
</div>
</section>
</section>
<section id="univariate-analysis" class="level1">
<h1>4.Univariate Analysis</h1>
<section id="age-distribution" class="level2">
<h2 class="anchored" data-anchor-id="age-distribution">4.1 Age Distribution</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">code</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Take-Home_Ex1_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heart_data, <span class="fu">aes</span>(<span class="at">x =</span> Age)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Age Distribution"</span>, <span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="heart-attack-occurrence" class="level2">
<h2 class="anchored" data-anchor-id="heart-attack-occurrence">4.2 Heart Attack Occurrence</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">code</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heart_data, <span class="fu">aes</span>(<span class="at">x =</span> Heart_Attack_Occurrence, <span class="at">fill =</span> Heart_Attack_Occurrence)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heart Attack Occurrence Count"</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heart_data, <span class="fu">aes</span>(<span class="at">x =</span> Heart_Attack_Occurrence, <span class="at">fill =</span> Heart_Attack_Occurrence)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heart Attack Occurrence Count"</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>As we can see that data is extremely unbalanced, <span class="cf">for</span> further EDA it would be better <span class="cf">if</span> we use a case my case basis to evaluate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="stratified-summary-statistics" class="level1">
<h1>5. Stratified Summary Statistics</h1>
<p>Since 90% of cases are “No” and 10% are “Yes”, we should analyze them separately for better insights.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>heart_data <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Heart_Attack_Occurrence) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_cholesterol =</span> <span class="fu">mean</span>(Cholesterol_Level, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_cholesterol =</span> <span class="fu">median</span>(Cholesterol_Level, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_age =</span> <span class="fu">mean</span>(Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_age =</span> <span class="fu">median</span>(Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  Heart_Attack_Occurrence avg_cholesterol median_cholesterol avg_age median_age
  &lt;chr&gt;                             &lt;dbl&gt;              &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;
1 No                                 200.               200.    48.5         48
2 Yes                                200.               200.    48.8         49</code></pre>
</div>
</div>
<p>From the data, we can observe:</p>
<p>The average cholesterol is quite similar between those who had a heart attack (199.79) and those who did not (199.91). The median cholesterol is also close between both groups, with the “No” group at 199.74 and the “Yes” group at 200.08. The average age is almost identical, with a slight increase in the group who experienced a heart attack (48.78) compared to the group who did not (48.46). The median age is similarly close, with the “No” group at 48 and the “Yes” group at 49.</p>
<section id="stratifed-correlation" class="level2">
<h2 class="anchored" data-anchor-id="stratifed-correlation">5.1 Stratifed Correlation</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>cor_yes <span class="ot">&lt;-</span> <span class="fu">cor</span>(heart_data[heart_data<span class="sc">$</span>Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"Yes"</span>, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">c</span>(<span class="st">"Cholesterol_Level"</span>, <span class="st">"Age"</span>, <span class="st">"BMI"</span>, <span class="st">"Stress_Levels"</span>, <span class="st">"Systolic_BP"</span>, <span class="st">"Diastolic_BP"</span>, <span class="st">"Heart_Rate"</span>)], </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>cor_no <span class="ot">&lt;-</span> <span class="fu">cor</span>(heart_data[heart_data<span class="sc">$</span>Heart_Attack_Occurrence <span class="sc">==</span> <span class="st">"No"</span>, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">c</span>(<span class="st">"Cholesterol_Level"</span>, <span class="st">"Age"</span>, <span class="st">"BMI"</span>, <span class="st">"Stress_Levels"</span>, <span class="st">"Systolic_BP"</span>, <span class="st">"Diastolic_BP"</span>, <span class="st">"Heart_Rate"</span>)], </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Correlation for Yes cases:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Correlation for Yes cases:"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_yes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  Cholesterol_Level          Age           BMI Stress_Levels
Cholesterol_Level       1.000000000  0.024893055  0.0013634639  0.0011737216
Age                     0.024893055  1.000000000  0.0039067877  0.0481198743
BMI                     0.001363464  0.003906788  1.0000000000  0.0007011648
Stress_Levels           0.001173722  0.048119874  0.0007011648  1.0000000000
Systolic_BP             0.008056854 -0.008678332  0.0014454088  0.0094062628
Diastolic_BP           -0.011926165  0.007947327 -0.0062075957 -0.0418252365
Heart_Rate             -0.012549857  0.021226952  0.0176801209  0.0220291135
                   Systolic_BP Diastolic_BP   Heart_Rate
Cholesterol_Level  0.008056854 -0.011926165 -0.012549857
Age               -0.008678332  0.007947327  0.021226952
BMI                0.001445409 -0.006207596  0.017680121
Stress_Levels      0.009406263 -0.041825237  0.022029114
Systolic_BP        1.000000000  0.022033777  0.005838594
Diastolic_BP       0.022033777  1.000000000 -0.023602091
Heart_Rate         0.005838594 -0.023602091  1.000000000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Correlation for No cases:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Correlation for No cases:"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_no)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  Cholesterol_Level          Age          BMI Stress_Levels
Cholesterol_Level      1.0000000000 -0.002930681  0.001274954 -0.0007789171
Age                   -0.0029306812  1.000000000 -0.009196905  0.0088178168
BMI                    0.0012749543 -0.009196905  1.000000000  0.0049668697
Stress_Levels         -0.0007789171  0.008817817  0.004966870  1.0000000000
Systolic_BP            0.0056531434 -0.010933637 -0.003146532  0.0031572010
Diastolic_BP           0.0005935822  0.005669359  0.002741309  0.0105791913
Heart_Rate             0.0177521821 -0.001770225  0.006838744  0.0019931076
                   Systolic_BP  Diastolic_BP   Heart_Rate
Cholesterol_Level  0.005653143  0.0005935822  0.017752182
Age               -0.010933637  0.0056693593 -0.001770225
BMI               -0.003146532  0.0027413085  0.006838744
Stress_Levels      0.003157201  0.0105791913  0.001993108
Systolic_BP        1.000000000  0.0086193388  0.001950470
Diastolic_BP       0.008619339  1.0000000000 -0.008395959
Heart_Rate         0.001950470 -0.0083959588  1.000000000</code></pre>
</div>
</div>
<p>Key takeaways: Cholesterol Level does not seem strongly correlated with any other feature in both groups.</p>
<p>The stress levels and age seem to have a slightly stronger relationship in the “Yes” group compared to the “No” group.</p>
<p>BMI, Blood Pressure (Systolic/Diastolic), and Heart Rate do not show strong correlations with any features, suggesting no immediate linear relationship.</p>
</section>
</section>
<section id="bivariate-analysis" class="level1">
<h1>6.Bivariate Analysis</h1>
<section id="heart-attack-by-age-group" class="level2">
<h2 class="anchored" data-anchor-id="heart-attack-by-age-group">6.1 Heart attack by age group</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>heart_data <span class="ot">&lt;-</span> heart_data <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age_Group =</span> <span class="fu">cut</span>(Age, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">70</span>, <span class="dv">100</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;30"</span>, <span class="st">"30-50"</span>, <span class="st">"50-70"</span>, <span class="st">"70+"</span>)))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heart_data, <span class="fu">aes</span>(<span class="at">x =</span> Age_Group, <span class="at">fill =</span> Heart_Attack_Occurrence)) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span>  <span class="co"># Proportion-based visualization</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Proportion of Heart Attacks by Age Group"</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex1_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="cholesterol-level-vs.-heart-attack" class="level2">
<h2 class="anchored" data-anchor-id="cholesterol-level-vs.-heart-attack">6.3 Cholesterol Level vs.&nbsp;Heart Attack</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heart_data, <span class="fu">aes</span>(<span class="at">x =</span> Heart_Attack_Occurrence, <span class="at">y =</span> Cholesterol_Level, <span class="at">fill =</span> Heart_Attack_Occurrence)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cholesterol Levels by Heart Attack Occurrence"</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex1_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="multivariate-analysis-relationships-between-multiple-variables" class="level1">
<h1>7. Multivariate Analysis (Relationships Between Multiple Variables)</h1>
<section id="heart-attack-by-smoking-and-alcohol-consumption" class="level2">
<h2 class="anchored" data-anchor-id="heart-attack-by-smoking-and-alcohol-consumption">7.1 Heart Attack by Smoking and Alcohol Consumption</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heart_data, <span class="fu">aes</span>(<span class="at">x =</span> Smoking_History, <span class="at">fill =</span> Heart_Attack_Occurrence)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Alcohol_Consumption) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Heart Attack Occurrence by Smoking &amp; Alcohol Consumption"</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex1_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Insights</p>
<p>If you look at the ratio or proportion of Yes to total within each group, you may find that certain combinations (e.g., “High” alcohol consumption + “Moderate/Yes” smoking) might have a higher relative incidence of heart attack.</p>
<p>Even though absolute counts of “No” dominate, comparing proportions can reveal risk patterns. For instance, if in “High” alcohol + “Moderate” smoking the share of Yes is noticeably larger than in “Low” alcohol + “No” smoking, that suggests a higher relative risk.</p>
</section>
</section>
<section id="statistical-visualizations-using-ggstatsplot" class="level1">
<h1>8.Statistical Visualizations Using ggstatsplot</h1>
<p>#8.1 Heart Attack vs.&nbsp;Stress Levels</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(<span class="at">data =</span> heart_data, </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">x =</span> Heart_Attack_Occurrence, </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> Stress_Levels, </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"p"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex1_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Insights</p>
<p>Statistical Significance vs.&nbsp;Practical Significance: Statistical Significance: The p-value (0.04) indicates a statistically significant difference in mean stress levels between the two groups at the 5% alpha level. Practical/Clinical Significance: The effect size (gHedges = 0.04) is very small, suggesting that although the difference is real (in a statistical sense), it may not be very large in magnitude. Distribution Overlap: If the violins largely overlap, it means many individuals in both groups share similar stress levels, so stress alone may not be a strong discriminator.</p>
</section>
<section id="violin-plot-bmi-distribution-by-heart-attack-occurrence" class="level1">
<h1>9.Violin Plot: BMI Distribution by Heart Attack Occurrence</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(heart_data, <span class="fu">aes</span>(<span class="at">x =</span> Heart_Attack_Occurrence, <span class="at">y =</span> BMI, <span class="at">fill =</span> Heart_Attack_Occurrence)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span>  <span class="co"># Adds individual points for clarity</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"BMI Distribution by Heart Attack Occurrence"</span>) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex1_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Slightly Higher BMI for “Yes”: People who had a heart attack may have a higher average BMI, though the difference may be modest. Overlap: Because the distributions overlap, BMI alone does not perfectly distinguish between heart attack occurrence. It may, however, be one contributing factor among others.</p>
</section>
<section id="heatmap-relationship-between-blood-pressure-heart-rate" class="level1">
<h1>10.Heatmap: Relationship Between Blood Pressure &amp; Heart Rate</h1>
<p>Using a heatmap, we visualize trends between systolic blood pressure, diastolic blood pressure, and heart rate.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)  <span class="co"># For reshaping data</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Select relevant numeric variables</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="ot">&lt;-</span> heart_data <span class="sc">%&gt;%</span> </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Systolic_BP, Diastolic_BP, Heart_Rate, BMI, Cholesterol_Level)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute correlation matrix</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(heatmap_data, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>melted_cor <span class="ot">&lt;-</span> <span class="fu">melt</span>(cor_matrix)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(melted_cor, <span class="fu">aes</span>(Var1, Var2, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(value, <span class="dv">2</span>)), <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Correlation Heatmap"</span>) <span class="sc">+</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex1_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Insights :</p>
<p>None of these variables strongly correlates with another (at least linearly). This can mean: Each risk factor might act somewhat independently. May need to consider non-linear relationships or interactions rather than simple linear correlations.</p>
<section id="principal-component-analysis-pca" class="level2">
<h2 class="anchored" data-anchor-id="principal-component-analysis-pca">11. Principal Component Analysis (PCA)</h2>
<p>See if numeric variables (e.g., Age, Cholesterol_Level, Stress_Levels, BMI, Heart_Rate, Systolic_BP, Diastolic_BP) separate “Yes” vs.&nbsp;“No” cases in a lower-dimensional space.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example PCA code</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>numeric_vars <span class="ot">&lt;-</span> heart_data <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Age, Cholesterol_Level, Stress_Levels, BMI, Heart_Rate, Systolic_BP, Diastolic_BP) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>pca_res <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(numeric_vars, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize PCA</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>pca_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca_res<span class="sc">$</span>x) <span class="sc">%&gt;%</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Heart_Attack_Occurrence =</span> heart_data<span class="sc">$</span>Heart_Attack_Occurrence[<span class="sc">!</span><span class="fu">is.na</span>(heart_data<span class="sc">$</span>Age)])  <span class="co"># align indices</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pca_data, <span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">color =</span> Heart_Attack_Occurrence)) <span class="sc">+</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"PCA of Numeric Variables"</span>,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"PC1"</span>,</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"PC2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Ex1_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Insight: If “Yes” and “No” points form distinct clusters, certain numeric factors may drive heart-attack risk. If they overlap heavily, numeric variables alone may not cleanly separate outcome</p>
</section>
</section>
<section id="random-forest" class="level1">
<h1>12. Random Forest</h1>
<section id="splitting-the-data-to-balance-it-out" class="level2">
<h2 class="anchored" data-anchor-id="splitting-the-data-to-balance-it-out">12.1 Splitting the data to balance it out</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Stratified split: 80% Training, 20% Testing</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>trainIndex <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(heart_data<span class="sc">$</span>Heart_Attack_Occurrence, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating Training and Testing Sets</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> heart_data[trainIndex, ]</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> heart_data[<span class="sc">-</span>trainIndex, ]</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Check class distribution in train and test sets</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(train_data<span class="sc">$</span>Heart_Attack_Occurrence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   No   Yes 
21629  2372 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(test_data<span class="sc">$</span>Heart_Attack_Occurrence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
  No  Yes 
5407  592 </code></pre>
</div>
</div>
</section>
<section id="training-a-random-forest" class="level2">
<h2 class="anchored" data-anchor-id="training-a-random-forest">12.2 Training a random forest</h2>
<p>``{r} # Load necessary libraries library(caret)</p>
</section>
<section id="define-cross-validation-with-stratified-folds" class="level2">
<h2 class="anchored" data-anchor-id="define-cross-validation-with-stratified-folds">Define Cross-validation with stratified folds</h2>
<p>control &lt;- trainControl(method = “cv”, number = 5, classProbs = TRUE, summaryFunction = twoClassSummary, savePredictions = “final”)</p>
<section id="train-a-random-forest-model-with-stratified-cross-validation" class="level3">
<h3 class="anchored" data-anchor-id="train-a-random-forest-model-with-stratified-cross-validation">Train a Random Forest model with stratified cross-validation</h3>
<p>rf_model &lt;- train(Heart_Attack_Occurrence ~ BMI + Systolic_BP + Age + Heart_Rate + Cholesterol_Level + Stress_Levels, data = train_data, method = “rf”, trControl = control, metric = “ROC”, # Use ROC-AUC for imbalanced data importance = TRUE)</p>
</section>
<section id="model-summary" class="level3">
<h3 class="anchored" data-anchor-id="model-summary">Model Summary</h3>
<p>print(rf_model)</p>
</section>
<section id="variable-importance" class="level3">
<h3 class="anchored" data-anchor-id="variable-importance">Variable Importance</h3>
<p>#varImpPlot(rf_model$finalModel)</p>
<p>##12.3 Plotting the outcome of random forest</p>
<p>`{r}</p>
<p>train_data<span class="math inline">\(Cholesterol_Level_Cat &lt;- cut(train_data\)</span>Cholesterol_Level, breaks=3, labels=c(“Low”, “Medium”, “High”))</p>
<p>ggplot(train_data, aes(x = BMI, y = Heart_Attack_Occurrence, color = Cholesterol_Level_Cat, group = Cholesterol_Level_Cat)) + stat_summary(fun = mean, geom = “line”, size = 1) + labs(title = “Interaction between BMI &amp; Cholesterol on Heart Attack Risk”, x = “BMI”, y = “Mean Heart Attack Risk”, color = “Cholesterol Level”) + theme_minimal()</p>
<p>Results :</p>
<p>Coefficients: Estimate Std. Error z value Pr(&gt;|z|)<br>
(Intercept) -0.0523207 0.1132713 -0.462 0.644149<br>
Age 0.0014766 0.0004992 2.958 0.003095 ** BMI -0.0031457 0.0018036 -1.744 0.081140 .<br>
Diastolic_BP 0.0009575 0.0008876 1.079 0.280740<br>
Heart_Rate 0.0011789 0.0008881 1.327 0.184387<br>
Stress_Levels -0.0155511 0.0044518 -3.493 0.000477 <strong><em>Smoking_HistoryYes 0.0336846 0.0193652 1.739 0.081958 .<br>
Hypertension_HistoryYes 0.0214626 0.0205319 1.045 0.295871<br>
Alcohol_ConsumptionModerate -0.0699551 0.0202636 -3.452 0.000556</em></strong> Alcohol_ConsumptionHigh -0.0105962 0.0243683 -0.435 0.663681<br>
Diet_QualityAverage 0.0414591 0.0245110 1.691 0.090751 .<br>
Diet_QualityGood 0.0662170 0.0244418 2.709 0.006745 ** Physical_ActivityModerate 0.0576200 0.0215000 2.680 0.007362 ** Physical_ActivityHigh -0.0004257 0.0229865 -0.019 0.985226<br>
Diabetes_HistoryYes 0.0684589 0.0218992 3.126 0.001771 ** — Signif. codes: 0 ‘<em><strong>’ 0.001 ’</strong>’ 0.01 ’</em>’ 0.05 ‘.’ 0.1 ’ ’ 1</p>
<p>(Dispersion parameter for binomial family taken to be 1)</p>
<pre><code>Null deviance: 70403  on 26984  degrees of freedom</code></pre>
<p>Residual deviance: 70331 on 26970 degrees of freedom (3015 observations deleted due to missingness) AIC: 70361</p>
<p>Number of Fisher Scoring iterations: 5 ```</p>
</section>
</section>
</section>
<section id="conclusion-and-summary" class="level1">
<h1>13. Conclusion and Summary</h1>
<section id="feature-importance-random-forest-model" class="level2">
<h2 class="anchored" data-anchor-id="feature-importance-random-forest-model">13.1 Feature Importance (Random Forest Model)</h2>
<p>Cholesterol Level and BMI are among the top predictors of heart attack risk. Systolic BP and Heart Rate also play a role but seem slightly less impactful. Age has the least importance in this specific model.</p>
</section>
<section id="interaction-between-bmi-cholesterol-on-heart-attack-risk" class="level2">
<h2 class="anchored" data-anchor-id="interaction-between-bmi-cholesterol-on-heart-attack-risk">13.2 Interaction Between BMI &amp; Cholesterol on Heart Attack Risk</h2>
<p>Higher cholesterol levels (blue line) show a consistently higher heart attack risk, but it slightly decreases as BMI increases. Lower cholesterol (red line) has a steeper decline in risk with increasing BMI. Medium cholesterol (green line) has a sharp drop at a certain BMI threshold, suggesting a possible nonlinear effect. Overall, cholesterol modifies the relationship between BMI and heart attack risk, showing an interaction effect. 3. Alternative Visualizations for Variable Comparisons</p>
<p>Boxplots &amp; Violin Plots: Could be used to check how heart attack risk varies across BMI and cholesterol levels. Scatter Plots with Color/Size Encoding: Helped check relationships between continuous variables like BMI, Cholesterol, and Heart Rate. 3D Scatter Plot: Would be useful to further explore trends across three continuous features.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>